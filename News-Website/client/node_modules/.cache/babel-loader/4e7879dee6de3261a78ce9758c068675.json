{"ast":null,"code":"import _regeneratorRuntime from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/src/components/Select.js\";\nimport React from \"react\";\nimport _ from \"lodash\";\nimport AsyncSelect from 'react-select/async';\nimport { withRouter } from 'react-router-dom';\n\nvar Select = /*#__PURE__*/function (_React$Component) {\n  _inherits(Select, _React$Component);\n\n  function Select() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Select);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Select)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      inputValue: '',\n      results: [],\n      selectedResult: '',\n      valueToSearch: {\n        label: '',\n        value: ''\n      }\n    };\n\n    _this.handleSearchChange = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var value, response, data, resultsRaw, results;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                value = _this.state.inputValue;\n                console.log(\"value to query\", value);\n                _context.prev = 2;\n                _context.next = 5;\n                return fetch(\"https://siqidu.cognitiveservices.azure.com/bing/v7.0/suggestions?q=\" + value, {\n                  headers: {\n                    \"Ocp-Apim-Subscription-Key\": \"1840826bbfa341e68c780e23fdd205c8\"\n                  }\n                });\n\n              case 5:\n                response = _context.sent;\n                _context.next = 8;\n                return response.json();\n\n              case 8:\n                data = _context.sent;\n                resultsRaw = data.suggestionGroups[0].searchSuggestions;\n                results = resultsRaw.map(function (result) {\n                  return {\n                    value: result.displayText,\n                    label: result.displayText\n                  };\n                });\n\n                _this.setState({\n                  results: results\n                });\n\n                return _context.abrupt(\"return\", _this.state.results);\n\n              case 15:\n                _context.prev = 15;\n                _context.t0 = _context[\"catch\"](2);\n                console.error(\"Error fetching search \".concat(value));\n\n              case 18:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[2, 15]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleResultSelect = function (newValue) {\n      _this.setState({\n        inputValue: newValue\n      });\n    };\n\n    _this.getSearchResult = function (option) {\n      var value = option['value'];\n\n      _this.setState({\n        selectedResult: value\n      });\n\n      localStorage.setItem(\"searchQuery\", value);\n\n      _this.props.history.push('/search/' + value);\n    };\n\n    return _this;\n  }\n\n  _createClass(Select, [{\n    key: \"componentWillReceiveProp\",\n    value: function componentWillReceiveProp() {\n      console.log(\"in search\", window.location.href);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(AsyncSelect, {\n        placeholder: \"Enter Keyword...\",\n        cacheOptions: true,\n        loadOptions: _.debounce(this.handleSearchChange, 1000, {\n          leading: true\n        }),\n        onInputChange: this.handleResultSelect,\n        onChange: this.getSearchResult,\n        value: this.state.inputValue,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Select;\n}(React.Component);\n\nexport default withRouter(Select);","map":{"version":3,"sources":["/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/src/components/Select.js"],"names":["React","_","AsyncSelect","withRouter","Select","state","inputValue","results","selectedResult","valueToSearch","label","value","handleSearchChange","event","console","log","fetch","headers","response","json","data","resultsRaw","suggestionGroups","searchSuggestions","map","result","displayText","setState","error","handleResultSelect","newValue","getSearchResult","option","localStorage","setItem","props","history","push","window","location","href","debounce","leading","Component"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,WAAP,MAAwB,oBAAxB;AACA,SAAQC,UAAR,QAAyB,kBAAzB;;IAGMC,M;;;;;;;;;;;;;;;UACJC,K,GAAQ;AACNC,MAAAA,UAAU,EAAE,EADN;AAENC,MAAAA,OAAO,EAAE,EAFH;AAGNC,MAAAA,cAAc,EAAE,EAHV;AAINC,MAAAA,aAAa,EAAC;AAACC,QAAAA,KAAK,EAAC,EAAP;AAAUC,QAAAA,KAAK,EAAC;AAAhB;AAJR,K;;UAYRC,kB;0EAAqB,iBAAOC,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACfF,gBAAAA,KADe,GACP,MAAKN,KAAL,CAAWC,UADJ;AAEnBQ,gBAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA6BJ,KAA7B;AAFmB;AAAA;AAAA,uBAKIK,KAAK,CAC1B,wEAAsEL,KAD5C,EAE1B;AACEM,kBAAAA,OAAO,EAAE;AACP,iDAA6B;AADtB;AADX,iBAF0B,CALT;;AAAA;AAKbC,gBAAAA,QALa;AAAA;AAAA,uBAaAA,QAAQ,CAACC,IAAT,EAbA;;AAAA;AAabC,gBAAAA,IAba;AAcbC,gBAAAA,UAda,GAcAD,IAAI,CAACE,gBAAL,CAAsB,CAAtB,EAAyBC,iBAdzB;AAebhB,gBAAAA,OAfa,GAeHc,UAAU,CAACG,GAAX,CAAe,UAAAC,MAAM;AAAA,yBAAK;AAAEd,oBAAAA,KAAK,EAAEc,MAAM,CAACC,WAAhB;AAA6BhB,oBAAAA,KAAK,EAAEe,MAAM,CAACC;AAA3C,mBAAL;AAAA,iBAArB,CAfG;;AAgBnB,sBAAKC,QAAL,CAAc;AAAEpB,kBAAAA,OAAO,EAAEA;AAAX,iBAAd;;AAhBmB,iDAiBZ,MAAKF,KAAL,CAAWE,OAjBC;;AAAA;AAAA;AAAA;AAmBnBO,gBAAAA,OAAO,CAACc,KAAR,iCAAuCjB,KAAvC;;AAnBmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;UAuBvBkB,kB,GAAqB,UAACC,QAAD,EAAa;AAChC,YAAKH,QAAL,CAAc;AAAErB,QAAAA,UAAU,EAAEwB;AAAd,OAAd;AACD,K;;UAEDC,e,GAAkB,UAACC,MAAD,EAAW;AACzB,UAAIrB,KAAK,GAAGqB,MAAM,CAAC,OAAD,CAAlB;;AACA,YAAKL,QAAL,CAAc;AAAEnB,QAAAA,cAAc,EAAGG;AAAnB,OAAd;;AACAsB,MAAAA,YAAY,CAACC,OAAb,CAAqB,aAArB,EAAmCvB,KAAnC;;AACA,YAAKwB,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,aAAW1B,KAAnC;AACH,K;;;;;;;+CArC0B;AACzBG,MAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAwBuB,MAAM,CAACC,QAAP,CAAgBC,IAAxC;AAED;;;6BAqCS;AACJ,aACE,oBAAC,WAAD;AAAa,QAAA,WAAW,EAAC,kBAAzB;AAA4C,QAAA,YAAY,MAAxD;AACA,QAAA,WAAW,EAAEvC,CAAC,CAACwC,QAAF,CAAW,KAAK7B,kBAAhB,EAAoC,IAApC,EAA0C;AAAC8B,UAAAA,OAAO,EAAE;AAAV,SAA1C,CADb;AAEA,QAAA,aAAa,EAAE,KAAKb,kBAFpB;AAGA,QAAA,QAAQ,EAAE,KAAKE,eAHf;AAIA,QAAA,KAAK,EAAI,KAAK1B,KAAL,CAAWC,UAJpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AAOH;;;;EAxDkBN,KAAK,CAAC2C,S;;AA2D3B,eAAexC,UAAU,CAACC,MAAD,CAAzB","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport AsyncSelect from 'react-select/async';\nimport {withRouter} from 'react-router-dom';\n\n\nclass Select extends React.Component{\n  state = {\n    inputValue: '',\n    results: [], \n    selectedResult: '',\n    valueToSearch:{label:'',value:''}\n}\n\ncomponentWillReceiveProp() {\n  console.log(\"in search\",window.location.href);\n  \n}\n\n  handleSearchChange = async (event) => {\n    var value = this.state.inputValue;\n    console.log(\"value to query\",value);\n\n  try {\n    const response = await fetch(\n      `https://siqidu.cognitiveservices.azure.com/bing/v7.0/suggestions?q=`+value,\n      {\n        headers: {\n          \"Ocp-Apim-Subscription-Key\": \"1840826bbfa341e68c780e23fdd205c8\"\n        }\n      }\n    );\n    const data = await response.json();\n    const resultsRaw = data.suggestionGroups[0].searchSuggestions;\n    const results = resultsRaw.map(result => ({ value: result.displayText, label: result.displayText }));\n    this.setState({ results: results });\n    return this.state.results;\n  } catch (error) {\n    console.error(`Error fetching search ${value}`);\n  }\n};\n\nhandleResultSelect = (newValue) =>{\n  this.setState({ inputValue: newValue });\n}\n\ngetSearchResult = (option) =>{\n    let value = option['value'];\n    this.setState({ selectedResult : value });\n    localStorage.setItem(\"searchQuery\",value);\n    this.props.history.push('/search/'+value);      \n}\n\n\n  render(){\n      return (\n        <AsyncSelect placeholder=\"Enter Keyword...\" cacheOptions \n        loadOptions={_.debounce(this.handleSearchChange, 1000, {leading: true})} \n        onInputChange={this.handleResultSelect} \n        onChange={this.getSearchResult} \n        value = {this.state.inputValue}/>\n      )\n  }\n}\n\nexport default withRouter(Select);\n"]},"metadata":{},"sourceType":"module"}