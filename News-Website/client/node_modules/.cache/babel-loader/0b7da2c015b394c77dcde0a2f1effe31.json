{"ast":null,"code":"!function (e, t) {\n  \"object\" == typeof exports && \"object\" == typeof module ? module.exports = t() : \"function\" == typeof define && define.amd ? define([], t) : \"object\" == typeof exports ? exports.commentBox = t() : e.commentBox = t();\n}(\"undefined\" != typeof self ? self : this, function () {\n  return function (e) {\n    var t = {};\n\n    function r(o) {\n      if (t[o]) return t[o].exports;\n      var n = t[o] = {\n        i: o,\n        l: !1,\n        exports: {}\n      };\n      return e[o].call(n.exports, n, n.exports, r), n.l = !0, n.exports;\n    }\n\n    return r.m = e, r.c = t, r.d = function (e, t, o) {\n      r.o(e, t) || Object.defineProperty(e, t, {\n        enumerable: !0,\n        get: o\n      });\n    }, r.r = function (e) {\n      \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {\n        value: \"Module\"\n      }), Object.defineProperty(e, \"__esModule\", {\n        value: !0\n      });\n    }, r.t = function (e, t) {\n      if (1 & t && (e = r(e)), 8 & t) return e;\n      if (4 & t && \"object\" == typeof e && e && e.__esModule) return e;\n      var o = Object.create(null);\n      if (r.r(o), Object.defineProperty(o, \"default\", {\n        enumerable: !0,\n        value: e\n      }), 2 & t && \"string\" != typeof e) for (var n in e) {\n        r.d(o, n, function (t) {\n          return e[t];\n        }.bind(null, n));\n      }\n      return o;\n    }, r.n = function (e) {\n      var t = e && e.__esModule ? function () {\n        return e.default;\n      } : function () {\n        return e;\n      };\n      return r.d(t, \"a\", t), t;\n    }, r.o = function (e, t) {\n      return Object.prototype.hasOwnProperty.call(e, t);\n    }, r.p = \"\", r(r.s = 3);\n  }([function (e, t, r) {\n    \"use strict\";\n\n    var o = r(4),\n        n = r(5),\n        a = r(2);\n    e.exports = {\n      formats: a,\n      parse: n,\n      stringify: o\n    };\n  }, function (e, t, r) {\n    \"use strict\";\n\n    var o = Object.prototype.hasOwnProperty,\n        n = function () {\n      for (var e = [], t = 0; t < 256; ++t) {\n        e.push(\"%\" + ((t < 16 ? \"0\" : \"\") + t.toString(16)).toUpperCase());\n      }\n\n      return e;\n    }(),\n        a = function a(e, t) {\n      for (var r = t && t.plainObjects ? Object.create(null) : {}, o = 0; o < e.length; ++o) {\n        void 0 !== e[o] && (r[o] = e[o]);\n      }\n\n      return r;\n    };\n\n    e.exports = {\n      arrayToObject: a,\n      assign: function assign(e, t) {\n        return Object.keys(t).reduce(function (e, r) {\n          return e[r] = t[r], e;\n        }, e);\n      },\n      compact: function compact(e) {\n        for (var t = [{\n          obj: {\n            o: e\n          },\n          prop: \"o\"\n        }], r = [], o = 0; o < t.length; ++o) {\n          for (var n = t[o], a = n.obj[n.prop], i = Object.keys(a), l = 0; l < i.length; ++l) {\n            var c = i[l],\n                s = a[c];\n            \"object\" == typeof s && null !== s && -1 === r.indexOf(s) && (t.push({\n              obj: a,\n              prop: c\n            }), r.push(s));\n          }\n        }\n\n        return function (e) {\n          for (var t; e.length;) {\n            var r = e.pop();\n\n            if (t = r.obj[r.prop], Array.isArray(t)) {\n              for (var o = [], n = 0; n < t.length; ++n) {\n                void 0 !== t[n] && o.push(t[n]);\n              }\n\n              r.obj[r.prop] = o;\n            }\n          }\n\n          return t;\n        }(t);\n      },\n      decode: function decode(e) {\n        try {\n          return decodeURIComponent(e.replace(/\\+/g, \" \"));\n        } catch (t) {\n          return e;\n        }\n      },\n      encode: function encode(e) {\n        if (0 === e.length) return e;\n\n        for (var t = \"string\" == typeof e ? e : String(e), r = \"\", o = 0; o < t.length; ++o) {\n          var a = t.charCodeAt(o);\n          45 === a || 46 === a || 95 === a || 126 === a || a >= 48 && a <= 57 || a >= 65 && a <= 90 || a >= 97 && a <= 122 ? r += t.charAt(o) : a < 128 ? r += n[a] : a < 2048 ? r += n[192 | a >> 6] + n[128 | 63 & a] : a < 55296 || a >= 57344 ? r += n[224 | a >> 12] + n[128 | a >> 6 & 63] + n[128 | 63 & a] : (o += 1, a = 65536 + ((1023 & a) << 10 | 1023 & t.charCodeAt(o)), r += n[240 | a >> 18] + n[128 | a >> 12 & 63] + n[128 | a >> 6 & 63] + n[128 | 63 & a]);\n        }\n\n        return r;\n      },\n      isBuffer: function isBuffer(e) {\n        return null !== e && void 0 !== e && !!(e.constructor && e.constructor.isBuffer && e.constructor.isBuffer(e));\n      },\n      isRegExp: function isRegExp(e) {\n        return \"[object RegExp]\" === Object.prototype.toString.call(e);\n      },\n      merge: function e(t, r, n) {\n        if (!r) return t;\n\n        if (\"object\" != typeof r) {\n          if (Array.isArray(t)) t.push(r);else {\n            if (\"object\" != typeof t) return [t, r];\n            (n.plainObjects || n.allowPrototypes || !o.call(Object.prototype, r)) && (t[r] = !0);\n          }\n          return t;\n        }\n\n        if (\"object\" != typeof t) return [t].concat(r);\n        var i = t;\n        return Array.isArray(t) && !Array.isArray(r) && (i = a(t, n)), Array.isArray(t) && Array.isArray(r) ? (r.forEach(function (r, a) {\n          o.call(t, a) ? t[a] && \"object\" == typeof t[a] ? t[a] = e(t[a], r, n) : t.push(r) : t[a] = r;\n        }), t) : Object.keys(r).reduce(function (t, a) {\n          var i = r[a];\n          return o.call(t, a) ? t[a] = e(t[a], i, n) : t[a] = i, t;\n        }, i);\n      }\n    };\n  }, function (e, t, r) {\n    \"use strict\";\n\n    var o = String.prototype.replace,\n        n = /%20/g;\n    e.exports = {\n      default: \"RFC3986\",\n      formatters: {\n        RFC1738: function RFC1738(e) {\n          return o.call(e, n, \"+\");\n        },\n        RFC3986: function RFC3986(e) {\n          return e;\n        }\n      },\n      RFC1738: \"RFC1738\",\n      RFC3986: \"RFC3986\"\n    };\n  }, function (e, t, r) {\n    \"use strict\";\n\n    r.r(t), r.d(t, \"default\", function () {\n      return i;\n    });\n    var o = r(0);\n    var n = {\n      className: \"commentbox\",\n      defaultBoxId: \"commentbox\",\n      tlcParam: \"tlc\",\n      backgroundColor: null,\n      textColor: null,\n      subtextColor: null,\n      singleSignOn: null,\n      createBoxUrl: function createBoxUrl(e, t) {\n        return t.search = \"\", t.hash = e, t.href;\n      },\n      onCommentCount: function onCommentCount(e) {},\n      testMode: !1\n    },\n        a = {\n      buttonText: \"Single Sign-On\",\n      buttonIcon: \"\",\n      buttonColor: \"\",\n      autoSignOn: !1,\n      onSignOn: function onSignOn(e, t) {},\n      onSignOut: function onSignOut() {}\n    };\n\n    function i(e) {\n      var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : n;\n      if (!e) throw new Error(\"Please supply a valid projectId.\");\n\n      var _Object$keys$reduce = Object.keys(n).reduce(function (e, r) {\n        return e[r] = t && t[r] ? t[r] : n[r], e;\n      }, {}),\n          r = _Object$keys$reduce.className,\n          i = _Object$keys$reduce.defaultBoxId,\n          l = _Object$keys$reduce.tlcParam,\n          c = _Object$keys$reduce.backgroundColor,\n          s = _Object$keys$reduce.textColor,\n          u = _Object$keys$reduce.subtextColor,\n          d = _Object$keys$reduce.createBoxUrl,\n          f = _Object$keys$reduce.onCommentCount,\n          p = _Object$keys$reduce.testMode;\n\n      var y = t.singleSignOn || null;\n      y && (y = Object.keys(a).reduce(function (e, t) {\n        return e[t] = y[t] || a[t], e;\n      }, {}));\n      var b = document.createElement(\"a\");\n      b.href = window.location.href;\n      var m = document.getElementsByClassName(r),\n          g = m.length,\n          h = {},\n          v = p ? \"localhost:8000\" : \"app.commentbox.io\",\n          O = p ? \"http:\" : \"https:\",\n          j = \"\".concat(O, \"//\").concat(v);\n\n      var _loop = function _loop(_t) {\n        var r = m[_t];\n        if (r.getAttribute(\"data-loaded\")) return \"continue\";\n        var n = r.id || i,\n            a = Object(o.parse)(b.search.replace(\"?\", \"\"))[l],\n            f = document.createElement(\"a\");\n        if (h[n]) throw new Error(\"Each box must have a unique ID\");\n        h[n] = !0, r.id = n, f.href = d(n, b);\n        var p = Object(o.parse)(f.search.replace(\"?\", \"\")),\n            g = Object.keys(p).reduce(function (e, t) {\n          return t.toLowerCase() !== l.toLowerCase() && (e[t] = p[t]), e;\n        }, {});\n        f.search = Object.keys(g).length > 0 ? \"?\".concat(Object(o.stringify)(g)) : \"\";\n\n        var v = document.createElement(\"iframe\"),\n            O = document.createElement(\"a\"),\n            w = {\n          id: n,\n          url: f.href,\n          tlc_param: l,\n          tlc: a,\n          background_color: c,\n          text_color: s,\n          subtext_color: u\n        },\n            x = function x() {\n          O.href = j, O.pathname = e, O.search = Object(o.stringify)(w), v.setAttribute(\"src\", O.href), v.setAttribute(\"frameborder\", \"0\"), v.setAttribute(\"scrolling\", \"no\"), v.setAttribute(\"style\", \"width: 100%\"), r.appendChild(v), r.setAttribute(\"data-loaded\", \"true\");\n        };\n\n        if (y) {\n          if (Object.assign(w, {\n            sso: \"1\",\n            sso_text: y.buttonText,\n            sso_icon: y.buttonIcon,\n            sso_color: y.buttonColor\n          }), y.autoSignOn) {\n            var _e2 = !1;\n\n            y.onSignOn(function (t) {\n              if (_e2) throw new Error(\"Callback already called.\");\n              _e2 = !0, t && (w.sso_user_payload = t), x();\n            }, function (t) {\n              if (_e2) throw new Error(\"Callback already called.\");\n              _e2 = !0, x();\n            });\n          } else x();\n        } else x();\n      };\n\n      for (var _t = 0; _t < g; _t++) {\n        var _ret = _loop(_t);\n\n        if (_ret === \"continue\") continue;\n      }\n\n      var w = function w(e) {\n        var t = document.createElement(\"a\");\n        if (t.href = e.origin, e.data && t.hostname === v || t.protocol === O) try {\n          var _t2 = JSON.parse(e.data),\n              _r = _t2.event,\n              _o = _t2.id,\n              _n = _t2.payload,\n              _a = document.getElementById(_o).firstChild;\n\n          if (!h[_o]) return;\n\n          switch (_r) {\n            case \"count\":\n              _a.setAttribute(\"data-comments-loaded\", \"true\"), f(_n);\n              break;\n\n            case \"resize\":\n              _a.height = \"\".concat(_n, \"px\");\n              break;\n\n            case \"tlc\":\n              _a.setAttribute(\"data-tlc\", _n);\n\n              break;\n\n            case \"sso-user-payload\":\n              if (y) {\n                var _t3 = !1;\n\n                y.onSignOn(function (r) {\n                  if (_t3) throw new Error(\"Callback already called.\");\n                  _t3 = !0;\n                  var o = JSON.stringify(r ? {\n                    event: \"sso-user-payload\",\n                    payload: r\n                  } : {\n                    event: \"sso-user-payload-error\",\n                    payload: \"Could not sign in.\"\n                  });\n                  e.source.postMessage(o, e.origin);\n                }, function (r) {\n                  if (_t3) throw new Error(\"Callback already called.\");\n                  _t3 = !0;\n                  var o = JSON.stringify({\n                    event: \"sso-user-payload-error\",\n                    payload: r.message\n                  });\n                  e.source.postMessage(o, e.origin);\n                });\n              }\n\n              break;\n\n            case \"sso-logout\":\n              y && y.onSignOut();\n          }\n\n          if (_a.getAttribute(\"data-comments-loaded\") && _a.getAttribute(\"data-tlc\") && !_a.getAttribute(\"data-tlc-scrolled\")) {\n            var _e = _a.getBoundingClientRect();\n\n            window.scrollTo(0, window.scrollY + _e.top + parseInt(_a.getAttribute(\"data-tlc\"))), _a.setAttribute(\"data-tlc-scrolled\", \"true\");\n          }\n        } catch (e) {}\n      };\n\n      return window.addEventListener(\"message\", w), function () {\n        window.removeEventListener(\"message\", w);\n      };\n    }\n  }, function (e, t, r) {\n    \"use strict\";\n\n    var o = r(1),\n        n = r(2),\n        a = {\n      brackets: function brackets(e) {\n        return e + \"[]\";\n      },\n      indices: function indices(e, t) {\n        return e + \"[\" + t + \"]\";\n      },\n      repeat: function repeat(e) {\n        return e;\n      }\n    },\n        i = Date.prototype.toISOString,\n        l = {\n      delimiter: \"&\",\n      encode: !0,\n      encoder: o.encode,\n      encodeValuesOnly: !1,\n      serializeDate: function serializeDate(e) {\n        return i.call(e);\n      },\n      skipNulls: !1,\n      strictNullHandling: !1\n    },\n        c = function e(t, r, n, a, i, c, s, u, d, f, p, y) {\n      var b = t;\n      if (\"function\" == typeof s) b = s(r, b);else if (b instanceof Date) b = f(b);else if (null === b) {\n        if (a) return c && !y ? c(r, l.encoder) : r;\n        b = \"\";\n      }\n      if (\"string\" == typeof b || \"number\" == typeof b || \"boolean\" == typeof b || o.isBuffer(b)) return c ? [p(y ? r : c(r, l.encoder)) + \"=\" + p(c(b, l.encoder))] : [p(r) + \"=\" + p(String(b))];\n      var m,\n          g = [];\n      if (void 0 === b) return g;\n      if (Array.isArray(s)) m = s;else {\n        var h = Object.keys(b);\n        m = u ? h.sort(u) : h;\n      }\n\n      for (var v = 0; v < m.length; ++v) {\n        var O = m[v];\n        i && null === b[O] || (g = Array.isArray(b) ? g.concat(e(b[O], n(r, O), n, a, i, c, s, u, d, f, p, y)) : g.concat(e(b[O], r + (d ? \".\" + O : \"[\" + O + \"]\"), n, a, i, c, s, u, d, f, p, y)));\n      }\n\n      return g;\n    };\n\n    e.exports = function (e, t) {\n      var r = e,\n          i = t ? o.assign({}, t) : {};\n      if (null !== i.encoder && void 0 !== i.encoder && \"function\" != typeof i.encoder) throw new TypeError(\"Encoder has to be a function.\");\n      var s = void 0 === i.delimiter ? l.delimiter : i.delimiter,\n          u = \"boolean\" == typeof i.strictNullHandling ? i.strictNullHandling : l.strictNullHandling,\n          d = \"boolean\" == typeof i.skipNulls ? i.skipNulls : l.skipNulls,\n          f = \"boolean\" == typeof i.encode ? i.encode : l.encode,\n          p = \"function\" == typeof i.encoder ? i.encoder : l.encoder,\n          y = \"function\" == typeof i.sort ? i.sort : null,\n          b = void 0 !== i.allowDots && i.allowDots,\n          m = \"function\" == typeof i.serializeDate ? i.serializeDate : l.serializeDate,\n          g = \"boolean\" == typeof i.encodeValuesOnly ? i.encodeValuesOnly : l.encodeValuesOnly;\n      if (void 0 === i.format) i.format = n.default;else if (!Object.prototype.hasOwnProperty.call(n.formatters, i.format)) throw new TypeError(\"Unknown format option provided.\");\n      var h,\n          v,\n          O = n.formatters[i.format];\n      \"function\" == typeof i.filter ? r = (v = i.filter)(\"\", r) : Array.isArray(i.filter) && (h = v = i.filter);\n      var j,\n          w = [];\n      if (\"object\" != typeof r || null === r) return \"\";\n      j = i.arrayFormat in a ? i.arrayFormat : \"indices\" in i ? i.indices ? \"indices\" : \"repeat\" : \"indices\";\n      var x = a[j];\n      h || (h = Object.keys(r)), y && h.sort(y);\n\n      for (var A = 0; A < h.length; ++A) {\n        var C = h[A];\n        d && null === r[C] || (w = w.concat(c(r[C], C, x, u, d, f ? p : null, v, y, b, m, O, g)));\n      }\n\n      var k = w.join(s),\n          S = !0 === i.addQueryPrefix ? \"?\" : \"\";\n      return k.length > 0 ? S + k : \"\";\n    };\n  }, function (e, t, r) {\n    \"use strict\";\n\n    var o = r(1),\n        n = Object.prototype.hasOwnProperty,\n        a = {\n      allowDots: !1,\n      allowPrototypes: !1,\n      arrayLimit: 20,\n      decoder: o.decode,\n      delimiter: \"&\",\n      depth: 5,\n      parameterLimit: 1e3,\n      plainObjects: !1,\n      strictNullHandling: !1\n    },\n        i = function i(e, t, r) {\n      if (e) {\n        var o = r.allowDots ? e.replace(/\\.([^.[]+)/g, \"[$1]\") : e,\n            a = /(\\[[^[\\]]*])/g,\n            i = /(\\[[^[\\]]*])/.exec(o),\n            l = i ? o.slice(0, i.index) : o,\n            c = [];\n\n        if (l) {\n          if (!r.plainObjects && n.call(Object.prototype, l) && !r.allowPrototypes) return;\n          c.push(l);\n        }\n\n        for (var s = 0; null !== (i = a.exec(o)) && s < r.depth;) {\n          if (s += 1, !r.plainObjects && n.call(Object.prototype, i[1].slice(1, -1)) && !r.allowPrototypes) return;\n          c.push(i[1]);\n        }\n\n        return i && c.push(\"[\" + o.slice(i.index) + \"]\"), function (e, t, r) {\n          for (var o = t, n = e.length - 1; n >= 0; --n) {\n            var a,\n                i = e[n];\n            if (\"[]\" === i) a = (a = []).concat(o);else {\n              a = r.plainObjects ? Object.create(null) : {};\n              var l = \"[\" === i.charAt(0) && \"]\" === i.charAt(i.length - 1) ? i.slice(1, -1) : i,\n                  c = parseInt(l, 10);\n              !isNaN(c) && i !== l && String(c) === l && c >= 0 && r.parseArrays && c <= r.arrayLimit ? (a = [])[c] = o : a[l] = o;\n            }\n            o = a;\n          }\n\n          return o;\n        }(c, t, r);\n      }\n    };\n\n    e.exports = function (e, t) {\n      var r = t ? o.assign({}, t) : {};\n      if (null !== r.decoder && void 0 !== r.decoder && \"function\" != typeof r.decoder) throw new TypeError(\"Decoder has to be a function.\");\n      if (r.ignoreQueryPrefix = !0 === r.ignoreQueryPrefix, r.delimiter = \"string\" == typeof r.delimiter || o.isRegExp(r.delimiter) ? r.delimiter : a.delimiter, r.depth = \"number\" == typeof r.depth ? r.depth : a.depth, r.arrayLimit = \"number\" == typeof r.arrayLimit ? r.arrayLimit : a.arrayLimit, r.parseArrays = !1 !== r.parseArrays, r.decoder = \"function\" == typeof r.decoder ? r.decoder : a.decoder, r.allowDots = \"boolean\" == typeof r.allowDots ? r.allowDots : a.allowDots, r.plainObjects = \"boolean\" == typeof r.plainObjects ? r.plainObjects : a.plainObjects, r.allowPrototypes = \"boolean\" == typeof r.allowPrototypes ? r.allowPrototypes : a.allowPrototypes, r.parameterLimit = \"number\" == typeof r.parameterLimit ? r.parameterLimit : a.parameterLimit, r.strictNullHandling = \"boolean\" == typeof r.strictNullHandling ? r.strictNullHandling : a.strictNullHandling, \"\" === e || null === e || void 0 === e) return r.plainObjects ? Object.create(null) : {};\n\n      for (var l = \"string\" == typeof e ? function (e, t) {\n        for (var r = {}, o = t.ignoreQueryPrefix ? e.replace(/^\\?/, \"\") : e, i = t.parameterLimit === 1 / 0 ? void 0 : t.parameterLimit, l = o.split(t.delimiter, i), c = 0; c < l.length; ++c) {\n          var s,\n              u,\n              d = l[c],\n              f = d.indexOf(\"]=\"),\n              p = -1 === f ? d.indexOf(\"=\") : f + 1;\n          -1 === p ? (s = t.decoder(d, a.decoder), u = t.strictNullHandling ? null : \"\") : (s = t.decoder(d.slice(0, p), a.decoder), u = t.decoder(d.slice(p + 1), a.decoder)), n.call(r, s) ? r[s] = [].concat(r[s]).concat(u) : r[s] = u;\n        }\n\n        return r;\n      }(e, r) : e, c = r.plainObjects ? Object.create(null) : {}, s = Object.keys(l), u = 0; u < s.length; ++u) {\n        var d = s[u],\n            f = i(d, l[d], r);\n        c = o.merge(c, f, r);\n      }\n\n      return o.compact(c);\n    };\n  }]).default;\n});","map":null,"metadata":{},"sourceType":"script"}