{"ast":null,"code":"import _regeneratorRuntime from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/src/components/Select.js\";\nimport React from \"react\";\nimport _ from \"lodash\";\nimport AsyncSelect from 'react-select/async';\nimport { withRouter } from 'react-router-dom';\n\nvar Select = /*#__PURE__*/function (_React$Component) {\n  _inherits(Select, _React$Component);\n\n  function Select() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Select);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Select)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      inputValue: '',\n      results: [],\n      selectedResult: {\n        label: '',\n        value: ''\n      }\n    };\n\n    _this.handleSearchChange = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var value, response, data, resultsRaw, results;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log(\"in handle search change locad the new options\");\n                value = _this.state.inputValue;\n                console.log(\"value to query\", value);\n                _context.prev = 3;\n                _context.next = 6;\n                return fetch(\"https://siqidu.cognitiveservices.azure.com/bing/v7.0/suggestions?q=\" + value, {\n                  headers: {\n                    \"Ocp-Apim-Subscription-Key\": \"1840826bbfa341e68c780e23fdd205c8\"\n                  }\n                });\n\n              case 6:\n                response = _context.sent;\n                _context.next = 9;\n                return response.json();\n\n              case 9:\n                data = _context.sent;\n                resultsRaw = data.suggestionGroups[0].searchSuggestions;\n                results = resultsRaw.map(function (result) {\n                  return {\n                    value: result.displayText,\n                    label: result.displayText\n                  };\n                });\n\n                _this.setState({\n                  results: results\n                });\n\n                return _context.abrupt(\"return\", _this.state.results);\n\n              case 16:\n                _context.prev = 16;\n                _context.t0 = _context[\"catch\"](3);\n                console.error(\"Error fetching search \".concat(value));\n\n              case 19:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[3, 16]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleInputChange = function (newValue) {\n      console.log(\"newVlue\", newValue);\n\n      _this.setState({\n        inputValue: newValue\n      });\n    };\n\n    _this.getSearchResult = function (option) {\n      var value = option['value']; // setTimeout( () => {this.setState({ selectedResult : option })} , 0);\n\n      _this.setState({\n        selectedResult: option\n      });\n\n      localStorage.setItem(\"searchQuery\", value);\n\n      _this.props.history.push('/search/' + value); // console.log(this.state);  \n\n    };\n\n    return _this;\n  }\n\n  _createClass(Select, [{\n    key: \"componentWillReceiveProp\",\n    value: function componentWillReceiveProp() {\n      console.log(\"in WillReceiveProp select\", window.location.href);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      console.log(\"component select mounted\");\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(AsyncSelect, {\n        className: \"select\",\n        placeholder: \"Enter Keyword...\",\n        cacheOptions: true,\n        loadOptions: _.debounce(this.handleSearchChange, 1000, {\n          leading: true\n        }),\n        defaultOptions: true,\n        onInputChange: this.handleInputChange,\n        onChange: this.getSearchResult,\n        value: this.state.selectedResult,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Select;\n}(React.Component);\n\nexport default withRouter(Select);","map":{"version":3,"sources":["/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/src/components/Select.js"],"names":["React","_","AsyncSelect","withRouter","Select","state","inputValue","results","selectedResult","label","value","handleSearchChange","event","console","log","fetch","headers","response","json","data","resultsRaw","suggestionGroups","searchSuggestions","map","result","displayText","setState","error","handleInputChange","newValue","getSearchResult","option","localStorage","setItem","props","history","push","window","location","href","debounce","leading","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport AsyncSelect from 'react-select/async';\nimport {withRouter} from 'react-router-dom';\n\n\nclass Select extends React.Component{\n  state = {\n    inputValue: '',\n    results: [], \n    selectedResult: {label:'',value:''}\n}\n\ncomponentWillReceiveProp() {\n  console.log(\"in WillReceiveProp select\",window.location.href);\n}\n\ncomponentDidMount(){\n  console.log(\"component select mounted\");\n}\n\n  handleSearchChange = async (event) => {\n    console.log(\"in handle search change locad the new options\");\n    var value = this.state.inputValue;\n    console.log(\"value to query\",value);\n\n  try {\n    const response = await fetch(\n      `https://siqidu.cognitiveservices.azure.com/bing/v7.0/suggestions?q=`+value,\n      {\n        headers: {\n          \"Ocp-Apim-Subscription-Key\": \"1840826bbfa341e68c780e23fdd205c8\"\n        }\n      }\n    );\n    const data = await response.json();\n    const resultsRaw = data.suggestionGroups[0].searchSuggestions;\n    const results = resultsRaw.map(result => ({ value: result.displayText, label: result.displayText }));\n    this.setState({ results: results });\n    return this.state.results;\n  } catch (error) {\n    console.error(`Error fetching search ${value}`);\n  }\n};\n\nhandleInputChange = (newValue) =>{\n  console.log(\"newVlue\",newValue);\n  this.setState({ inputValue: newValue });\n}\n\ngetSearchResult = (option) =>{\n    let value = option['value'];\n    // setTimeout( () => {this.setState({ selectedResult : option })} , 0);\n    this.setState({ selectedResult : option })\n    localStorage.setItem(\"searchQuery\",value);\n    this.props.history.push('/search/'+value);    \n    // console.log(this.state);  \n}\n\n\n  render(){\n      return (\n        <AsyncSelect className=\"select\" \n        placeholder=\"Enter Keyword...\" \n        cacheOptions \n        loadOptions={_.debounce(this.handleSearchChange, 1000, {leading: true})} \n        defaultOptions\n        onInputChange={this.handleInputChange} \n        onChange={this.getSearchResult} \n        value = {this.state.selectedResult}/>\n      )\n  }\n}\n\nexport default withRouter(Select);\n"]},"metadata":{},"sourceType":"module"}