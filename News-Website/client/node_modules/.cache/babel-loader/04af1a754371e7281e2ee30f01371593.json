{"ast":null,"code":"import _regeneratorRuntime from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/src/components/Select.js\";\nimport React from \"react\";\nimport _ from \"lodash\";\nimport AsyncSelect from 'react-select/async';\nimport { withRouter } from 'react-router-dom';\n\nvar Select = /*#__PURE__*/function (_React$Component) {\n  _inherits(Select, _React$Component);\n\n  function Select() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Select);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Select)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      inputValue: '',\n      results: [],\n      selectedResult: {\n        label: '',\n        value: ''\n      }\n    };\n\n    _this.handleSearchChange = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var value, response, data, resultsRaw, results;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                value = _this.state.inputValue;\n                _context.prev = 1;\n                _context.next = 4;\n                return fetch(\"https://siqidu.cognitiveservices.azure.com/bing/v7.0/suggestions?q=\" + value, {\n                  headers: {\n                    \"Ocp-Apim-Subscription-Key\": \"1840826bbfa341e68c780e23fdd205c8\"\n                  }\n                });\n\n              case 4:\n                response = _context.sent;\n                _context.next = 7;\n                return response.json();\n\n              case 7:\n                data = _context.sent;\n                resultsRaw = data.suggestionGroups[0].searchSuggestions;\n                results = resultsRaw.map(function (result) {\n                  return {\n                    value: result.displayText,\n                    label: result.displayText\n                  };\n                });\n\n                _this.setState({\n                  results: results\n                });\n\n                return _context.abrupt(\"return\", _this.state.results);\n\n              case 14:\n                _context.prev = 14;\n                _context.t0 = _context[\"catch\"](1);\n                console.error(\"Error fetching search \".concat(value));\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 14]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleInputChange = function (newValue) {\n      _this.setState({\n        inputValue: newValue\n      });\n    };\n\n    _this.getSearchResult = function (option) {\n      var value = option['value'];\n\n      _this.setState({\n        selectedResult: option\n      });\n\n      localStorage.setItem(\"searchQuery\", value);\n\n      _this.props.history.push('/search/' + value);\n    };\n\n    _this.clearValues = function () {\n      _this.setState({\n        selectedResult: ''\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Select, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(AsyncSelect, {\n        className: \"select\",\n        placeholder: \"Enter Keyword...\",\n        cacheOptions: true,\n        loadOptions: _.debounce(this.handleSearchChange, 1000, {\n          leading: true\n        }),\n        defaultOptions: true,\n        onInputChange: this.handleInputChange,\n        onChange: this.getSearchResult,\n        value: this.state.selectedResult,\n        onBlur: this.clearValues,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Select;\n}(React.Component);\n\nexport default withRouter(Select);","map":{"version":3,"sources":["/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/src/components/Select.js"],"names":["React","_","AsyncSelect","withRouter","Select","state","inputValue","results","selectedResult","label","value","handleSearchChange","event","fetch","headers","response","json","data","resultsRaw","suggestionGroups","searchSuggestions","map","result","displayText","setState","console","error","handleInputChange","newValue","getSearchResult","option","localStorage","setItem","props","history","push","clearValues","debounce","leading","Component"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,WAAP,MAAwB,oBAAxB;AACA,SAAQC,UAAR,QAAyB,kBAAzB;;IAGMC,M;;;;;;;;;;;;;;;UACJC,K,GAAQ;AACNC,MAAAA,UAAU,EAAE,EADN;AAENC,MAAAA,OAAO,EAAE,EAFH;AAGNC,MAAAA,cAAc,EAAE;AAACC,QAAAA,KAAK,EAAC,EAAP;AAAUC,QAAAA,KAAK,EAAC;AAAhB;AAHV,K;;UAcRC,kB;0EAAqB,iBAAOC,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACfF,gBAAAA,KADe,GACP,MAAKL,KAAL,CAAWC,UADJ;AAAA;AAAA;AAAA,uBAIIO,KAAK,CAC1B,wEAAsEH,KAD5C,EAE1B;AACEI,kBAAAA,OAAO,EAAE;AACP,iDAA6B;AADtB;AADX,iBAF0B,CAJT;;AAAA;AAIbC,gBAAAA,QAJa;AAAA;AAAA,uBAYAA,QAAQ,CAACC,IAAT,EAZA;;AAAA;AAYbC,gBAAAA,IAZa;AAabC,gBAAAA,UAba,GAaAD,IAAI,CAACE,gBAAL,CAAsB,CAAtB,EAAyBC,iBAbzB;AAcbb,gBAAAA,OAda,GAcHW,UAAU,CAACG,GAAX,CAAe,UAAAC,MAAM;AAAA,yBAAK;AAAEZ,oBAAAA,KAAK,EAAEY,MAAM,CAACC,WAAhB;AAA6Bd,oBAAAA,KAAK,EAAEa,MAAM,CAACC;AAA3C,mBAAL;AAAA,iBAArB,CAdG;;AAenB,sBAAKC,QAAL,CAAc;AAAEjB,kBAAAA,OAAO,EAAEA;AAAX,iBAAd;;AAfmB,iDAgBZ,MAAKF,KAAL,CAAWE,OAhBC;;AAAA;AAAA;AAAA;AAkBnBkB,gBAAAA,OAAO,CAACC,KAAR,iCAAuChB,KAAvC;;AAlBmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;UAsBvBiB,iB,GAAoB,UAACC,QAAD,EAAa;AAC/B,YAAKJ,QAAL,CAAc;AAAElB,QAAAA,UAAU,EAAEsB;AAAd,OAAd;AACD,K;;UAEDC,e,GAAkB,UAACC,MAAD,EAAW;AACzB,UAAIpB,KAAK,GAAGoB,MAAM,CAAC,OAAD,CAAlB;;AACA,YAAKN,QAAL,CAAc;AAAEhB,QAAAA,cAAc,EAAGsB;AAAnB,OAAd;;AACAC,MAAAA,YAAY,CAACC,OAAb,CAAqB,aAArB,EAAmCtB,KAAnC;;AACA,YAAKuB,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,aAAWzB,KAAnC;AACH,K;;UACD0B,W,GAAc,YAAK;AACjB,YAAKZ,QAAL,CAAc;AAAChB,QAAAA,cAAc,EAAC;AAAhB,OAAd;AACD,K;;;;;;;6BAES;AACJ,aACE,oBAAC,WAAD;AAAa,QAAA,SAAS,EAAC,QAAvB;AACA,QAAA,WAAW,EAAC,kBADZ;AAEA,QAAA,YAAY,MAFZ;AAGA,QAAA,WAAW,EAAEP,CAAC,CAACoC,QAAF,CAAW,KAAK1B,kBAAhB,EAAoC,IAApC,EAA0C;AAAC2B,UAAAA,OAAO,EAAE;AAAV,SAA1C,CAHb;AAIA,QAAA,cAAc,MAJd;AAKA,QAAA,aAAa,EAAE,KAAKX,iBALpB;AAMA,QAAA,QAAQ,EAAE,KAAKE,eANf;AAOA,QAAA,KAAK,EAAI,KAAKxB,KAAL,CAAWG,cAPpB;AAQA,QAAA,MAAM,EAAG,KAAK4B,WARd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AAWH;;;;EA/DkBpC,KAAK,CAACuC,S;;AAkE3B,eAAepC,UAAU,CAACC,MAAD,CAAzB","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport AsyncSelect from 'react-select/async';\nimport {withRouter} from 'react-router-dom';\n\n\nclass Select extends React.Component{\n  state = {\n    inputValue: '',\n    results: [], \n    selectedResult: {label:'',value:''}\n}\n\n// componentWillReceiveProp() {\n//   console.log(\"in WillReceiveProp select\",window.location.href);\n// }\n\n// componentDidMount(){\n//   console.log(\"component select mounted\");\n// }\n\n  handleSearchChange = async (event) => {\n    var value = this.state.inputValue;\n\n  try {\n    const response = await fetch(\n      `https://siqidu.cognitiveservices.azure.com/bing/v7.0/suggestions?q=`+value,\n      {\n        headers: {\n          \"Ocp-Apim-Subscription-Key\": \"1840826bbfa341e68c780e23fdd205c8\"\n        }\n      }\n    );\n    const data = await response.json();\n    const resultsRaw = data.suggestionGroups[0].searchSuggestions;\n    const results = resultsRaw.map(result => ({ value: result.displayText, label: result.displayText }));\n    this.setState({ results: results });\n    return this.state.results;\n  } catch (error) {\n    console.error(`Error fetching search ${value}`);\n  }\n};\n\nhandleInputChange = (newValue) =>{\n  this.setState({ inputValue: newValue });\n}\n\ngetSearchResult = (option) =>{\n    let value = option['value'];\n    this.setState({ selectedResult : option })\n    localStorage.setItem(\"searchQuery\",value);\n    this.props.history.push('/search/'+value);    \n}\nclearValues = () =>{\n  this.setState({selectedResult:''});\n}\n\n  render(){\n      return (\n        <AsyncSelect className=\"select\" \n        placeholder=\"Enter Keyword...\" \n        cacheOptions \n        loadOptions={_.debounce(this.handleSearchChange, 1000, {leading: true})} \n        defaultOptions\n        onInputChange={this.handleInputChange} \n        onChange={this.getSearchResult} \n        value = {this.state.selectedResult}\n        onBlur ={this.clearValues}/>\n      )\n  }\n}\n\nexport default withRouter(Select);\n"]},"metadata":{},"sourceType":"module"}