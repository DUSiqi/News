{"ast":null,"code":"import _regeneratorRuntime from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/src/components/Select.js\";\nimport React from \"react\";\nimport _ from \"lodash\";\nimport AsyncSelect from 'react-select/async';\nimport { BrowserRouter, Route, Switch, Link, Redirect, withRouter } from 'react-router-dom';\n\nvar Select = /*#__PURE__*/function (_React$Component) {\n  _inherits(Select, _React$Component);\n\n  function Select() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Select);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Select)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      inputValue: '',\n      results: [],\n      selectedResult: ''\n    };\n\n    _this.handleSearchChange = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var value, response, data, resultsRaw, results;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log(\"in handleSearchChange function\");\n                value = _this.state.inputValue;\n                console.log(\"value to query\", value);\n                _context.prev = 3;\n                _context.next = 6;\n                return fetch(\"https://siqidu.cognitiveservices.azure.com/bing/v7.0/suggestions?q=\" + value, {\n                  headers: {\n                    \"Ocp-Apim-Subscription-Key\": \"1840826bbfa341e68c780e23fdd205c8\"\n                  }\n                });\n\n              case 6:\n                response = _context.sent;\n                _context.next = 9;\n                return response.json();\n\n              case 9:\n                data = _context.sent;\n                console.log(data);\n                resultsRaw = data.suggestionGroups[0].searchSuggestions;\n                results = resultsRaw.map(function (result) {\n                  return {\n                    value: result.displayText,\n                    label: result.displayText\n                  };\n                });\n                console.log(\"suggestion results:\", results);\n\n                _this.setState({\n                  results: results\n                });\n\n                return _context.abrupt(\"return\", _this.state.results);\n\n              case 18:\n                _context.prev = 18;\n                _context.t0 = _context[\"catch\"](3);\n                console.error(\"Error fetching search \".concat(value));\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[3, 18]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleResultSelect = function (newValue) {\n      console.log(\"newValue inputed\", newValue);\n\n      _this.setState({\n        inputValue: newValue\n      });\n    };\n\n    _this.getSearchResult = function (option) {\n      var value = option['value'];\n      console.log(\"value:\", value);\n\n      _this.setState({\n        selectedResult: value\n      }); //   window.location = ;\n\n\n      var url = '/search?q=' + value; //   window.history.replaceState({url:url},0,url);\n\n      _this.props.history.push('/search');\n    };\n\n    return _this;\n  }\n\n  _createClass(Select, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(AsyncSelect, {\n        cacheOptions: true,\n        loadOptions: _.debounce(this.handleSearchChange, 1000, {\n          leading: true\n        }),\n        onInputChange: this.handleResultSelect,\n        onChange: this.getSearchResult,\n        value: this.state.inputValue,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Select;\n}(React.Component);\n\nexport default withRouter(Select);","map":{"version":3,"sources":["/Users/dusiqi/Desktop/CSCI-571/HWS/hw8/NewsApp/client/src/components/Select.js"],"names":["React","_","AsyncSelect","BrowserRouter","Route","Switch","Link","Redirect","withRouter","Select","state","inputValue","results","selectedResult","handleSearchChange","event","console","log","value","fetch","headers","response","json","data","resultsRaw","suggestionGroups","searchSuggestions","map","result","displayText","label","setState","error","handleResultSelect","newValue","getSearchResult","option","url","props","history","push","debounce","leading","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport AsyncSelect from 'react-select/async';\nimport {BrowserRouter,Route, Switch, Link,Redirect,withRouter} from 'react-router-dom';\n\n\nclass Select extends React.Component{\n  state = {\n    inputValue: '',\n    results: [], \n    selectedResult: ''\n}\n\n  handleSearchChange = async (event) => {\n    console.log(\"in handleSearchChange function\");\n    var value = this.state.inputValue;\n    console.log(\"value to query\",value);\n\n  try {\n    const response = await fetch(\n      `https://siqidu.cognitiveservices.azure.com/bing/v7.0/suggestions?q=`+value,\n      {\n        headers: {\n          \"Ocp-Apim-Subscription-Key\": \"1840826bbfa341e68c780e23fdd205c8\"\n        }\n      }\n    );\n    const data = await response.json();\n    console.log(data);\n    const resultsRaw = data.suggestionGroups[0].searchSuggestions;\n    const results = resultsRaw.map(result => ({ value: result.displayText, label: result.displayText }));\n    console.log(\"suggestion results:\",results);\n    this.setState({ results: results });\n    return this.state.results;\n  } catch (error) {\n    console.error(`Error fetching search ${value}`);\n  }\n};\n\nhandleResultSelect = (newValue) =>{\n    console.log(\"newValue inputed\",newValue);\n  this.setState({ inputValue: newValue });\n}\n\ngetSearchResult = (option) =>{\n    let value = option['value'];\n    console.log(\"value:\",value);\n    this.setState({ selectedResult : value });\n      //   window.location = ;\n      let url = '/search?q='+value;\n  //   window.history.replaceState({url:url},0,url);\n  this.props.history.push('/search');      \n}\n\n  render(){\n      return (\n        <AsyncSelect cacheOptions loadOptions={_.debounce(this.handleSearchChange, 1000, {leading: true})} onInputChange={this.handleResultSelect} \n    onChange={this.getSearchResult} value = {this.state.inputValue}/>\n      )\n    \n      \n  }\n}\n\n\n\nexport default withRouter(Select);\n"]},"metadata":{},"sourceType":"module"}